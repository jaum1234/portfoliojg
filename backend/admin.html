<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Administração - Portfólio JG</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Estilos específicos para o painel de administração */
        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .admin-nav {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .admin-nav button {
            padding: 10px 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .admin-nav button.active {
            background-color: var(--accent-color);
        }
        
        .admin-section {
            display: none;
            margin-bottom: 40px;
        }
        
        .admin-section.active {
            display: block;
        }
        
        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .admin-table th, .admin-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        
        .admin-table th {
            background-color: var(--bg-secondary);
        }
        
        .admin-form {
            background-color: var(--bg-secondary);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .admin-form h3 {
            margin-top: 0;
            margin-bottom: 20px;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .form-group {
            flex: 1;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }
        
        .form-group textarea {
            min-height: 100px;
        }
        
        .thumbnail-preview {
            max-width: 200px;
            max-height: 120px;
            margin-top: 10px;
            border-radius: 4px;
            display: none;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        
        .btn-edit, .btn-delete {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .btn-edit {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-delete {
            background-color: #e74c3c;
            color: white;
        }
        
        .export-section {
            margin-top: 40px;
            padding: 20px;
            background-color: var(--bg-secondary);
            border-radius: 8px;
        }
        
        .login-container {
            max-width: 400px;
            margin: 100px auto;
            padding: 30px;
            background-color: var(--bg-secondary);
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .login-container h2 {
            margin-top: 0;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .notification {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
            display: none;
        }
        
        .notification.success {
            background-color: #2ecc71;
            color: white;
        }
        
        .notification.error {
            background-color: #e74c3c;
            color: white;
        }
        
        /* Responsividade */
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 15px;
            }
            
            .admin-table {
                font-size: 14px;
            }
            
            .admin-table th, .admin-table td {
                padding: 8px;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div id="login-page">
        <div class="login-container">
            <h2 class="lang-pt">Login Administrativo</h2>
            <h2 class="lang-en">Admin Login</h2>
            
            <div class="notification" id="login-notification"></div>
            
            <form id="login-form">
                <div class="form-group">
                    <label for="username" class="lang-pt">Nome de Utilizador</label>
                    <label for="username" class="lang-en">Username</label>
                    <input type="text" id="username" required>
                </div>
                
                <div class="form-group">
                    <label for="password" class="lang-pt">Senha</label>
                    <label for="password" class="lang-en">Password</label>
                    <input type="password" id="password" required>
                </div>
                
                <button type="submit" class="btn">
                    <span class="lang-pt">Entrar</span>
                    <span class="lang-en">Login</span>
                </button>
            </form>
        </div>
    </div>

    <div id="admin-page" style="display: none;">
        <header>
            <div class="container">
                <div class="logo">Portfólio JG - Admin</div>
                <nav>
                    <div class="language-toggle">
                        <button id="pt-btn" class="active">PT</button>
                        <button id="en-btn">EN</button>
                    </div>
                    <div class="theme-toggle">
                        <button id="theme-toggle-btn">
                            <i class="fas fa-moon"></i>
                        </button>
                    </div>
                    <button id="logout-btn" class="btn">
                        <span class="lang-pt">Sair</span>
                        <span class="lang-en">Logout</span>
                    </button>
                </nav>
            </div>
        </header>

        <main class="admin-container">
            <div class="admin-header">
                <h1 class="lang-pt">Painel de Administração</h1>
                <h1 class="lang-en">Administration Panel</h1>
            </div>
            
            <div class="notification" id="admin-notification"></div>
            
            <div class="admin-nav">
                <button id="videos-nav" class="active">
                    <span class="lang-pt">Vídeos</span>
                    <span class="lang-en">Videos</span>
                </button>
                <button id="categories-nav">
                    <span class="lang-pt">Categorias</span>
                    <span class="lang-en">Categories</span>
                </button>
            </div>
            
            <!-- Seção de Vídeos -->
            <section id="videos-section" class="admin-section active">
                <h2 class="lang-pt">Gestão de Vídeos</h2>
                <h2 class="lang-en">Video Management</h2>
                
                <form id="video-form" class="admin-form">
                    <h3 class="lang-pt">Adicionar/Editar Vídeo</h3>
                    <h3 class="lang-en">Add/Edit Video</h3>
                    
                    <input type="hidden" id="video-id">
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="video-title-pt" class="lang-pt">Título (Português)</label>
                            <label for="video-title-pt" class="lang-en">Title (Portuguese)</label>
                            <input type="text" id="video-title-pt" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="video-title-en" class="lang-pt">Título (Inglês)</label>
                            <label for="video-title-en" class="lang-en">Title (English)</label>
                            <input type="text" id="video-title-en" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="video-desc-pt" class="lang-pt">Descrição (Português)</label>
                            <label for="video-desc-pt" class="lang-en">Description (Portuguese)</label>
                            <textarea id="video-desc-pt" required></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="video-desc-en" class="lang-pt">Descrição (Inglês)</label>
                            <label for="video-desc-en" class="lang-en">Description (English)</label>
                            <textarea id="video-desc-en" required></textarea>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="video-thumbnail" class="lang-pt">URL da Miniatura</label>
                            <label for="video-thumbnail" class="lang-en">Thumbnail URL</label>
                            <input type="url" id="video-thumbnail" required>
                            <img id="thumbnail-preview" class="thumbnail-preview">
                        </div>
                        
                        <div class="form-group">
                            <label for="video-url" class="lang-pt">URL do Vídeo</label>
                            <label for="video-url" class="lang-en">Video URL</label>
                            <input type="url" id="video-url" required>
                            <small class="lang-pt">URL do YouTube ou Google Drive</small>
                            <small class="lang-en">YouTube or Google Drive URL</small>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="video-category" class="lang-pt">Categoria</label>
                            <label for="video-category" class="lang-en">Category</label>
                            <select id="video-category" required></select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <button type="submit" class="btn">
                            <span class="lang-pt">Salvar Vídeo</span>
                            <span class="lang-en">Save Video</span>
                        </button>
                        <button type="button" id="cancel-video" class="btn">
                            <span class="lang-pt">Cancelar</span>
                            <span class="lang-en">Cancel</span>
                        </button>
                    </div>
                </form>
                
                <table class="admin-table" id="videos-table">
                    <thead>
                        <tr>
                            <th class="lang-pt">Título</th>
                            <th class="lang-en">Title</th>
                            <th class="lang-pt">Miniatura</th>
                            <th class="lang-en">Thumbnail</th>
                            <th class="lang-pt">Categoria</th>
                            <th class="lang-en">Category</th>
                            <th class="lang-pt">Ações</th>
                            <th class="lang-en">Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>
            
            <!-- Seção de Categorias -->
            <section id="categories-section" class="admin-section">
                <h2 class="lang-pt">Gestão de Categorias</h2>
                <h2 class="lang-en">Category Management</h2>
                
                <form id="category-form" class="admin-form">
                    <h3 class="lang-pt">Adicionar/Editar Categoria</h3>
                    <h3 class="lang-en">Add/Edit Category</h3>
                    
                    <input type="hidden" id="category-id-hidden">
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="category-id" class="lang-pt">ID da Categoria</label>
                            <label for="category-id" class="lang-en">Category ID</label>
                            <input type="text" id="category-id" required>
                            <small class="lang-pt">Identificador único (sem espaços, apenas letras e números)</small>
                            <small class="lang-en">Unique identifier (no spaces, only letters and numbers)</small>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="category-name-pt" class="lang-pt">Nome (Português)</label>
                            <label for="category-name-pt" class="lang-en">Name (Portuguese)</label>
                            <input type="text" id="category-name-pt" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="category-name-en" class="lang-pt">Nome (Inglês)</label>
                            <label for="category-name-en" class="lang-en">Name (English)</label>
                            <input type="text" id="category-name-en" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <button type="submit" class="btn">
                            <span class="lang-pt">Salvar Categoria</span>
                            <span class="lang-en">Save Category</span>
                        </button>
                        <button type="button" id="cancel-category" class="btn">
                            <span class="lang-pt">Cancelar</span>
                            <span class="lang-en">Cancel</span>
                        </button>
                    </div>
                </form>
                
                <table class="admin-table" id="categories-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th class="lang-pt">Nome (PT)</th>
                            <th class="lang-en">Name (PT)</th>
                            <th class="lang-pt">Nome (EN)</th>
                            <th class="lang-en">Name (EN)</th>
                            <th class="lang-pt">Ações</th>
                            <th class="lang-en">Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>
            
            <!-- Seção de Exportação -->
            <section class="export-section">
                <h2 class="lang-pt">Exportar Dados</h2>
                <h2 class="lang-en">Export Data</h2>
                
                <p class="lang-pt">
                    Após fazer alterações, clique no botão abaixo para exportar o ficheiro data.js atualizado.
                    Depois, faça upload deste ficheiro para o Netlify para atualizar o seu site.
                </p>
                <p class="lang-en">
                    After making changes, click the button below to export the updated data.js file.
                    Then, upload this file to Netlify to update your site.
                </p>
                
                <button id="export-btn" class="btn">
                    <span class="lang-pt">Exportar data.js</span>
                    <span class="lang-en">Export data.js</span>
                </button>
            </section>
        </main>

        <footer>
            <div class="container">
                <p>&copy; 2025 Portfólio JG - Painel Administrativo</p>
            </div>
        </footer>
    </div>

    <script src="js/data.js"></script>
    <script>
        // Configurações de autenticação
        const adminCredentials = {
            username: 'admin',
            password: 'portfoliojg2025'
        };
        
        // Estado da aplicação
        let currentLanguage = 'pt';
        let isDarkTheme = false;
        let videosData = [...videos];
        let categoriesData = [...categories];
        let editingVideoId = null;
        let editingCategoryId = null;
        
        // Elementos DOM
        const loginPage = document.getElementById('login-page');
        const adminPage = document.getElementById('admin-page');
        const loginForm = document.getElementById('login-form');
        const loginNotification = document.getElementById('login-notification');
        const adminNotification = document.getElementById('admin-notification');
        const videosNav = document.getElementById('videos-nav');
        const categoriesNav = document.getElementById('categories-nav');
        const videosSection = document.getElementById('videos-section');
        const categoriesSection = document.getElementById('categories-section');
        const videoForm = document.getElementById('video-form');
        const categoryForm = document.getElementById('category-form');
        const videosTable = document.getElementById('videos-table').querySelector('tbody');
        const categoriesTable = document.getElementById('categories-table').querySelector('tbody');
        const logoutBtn = document.getElementById('logout-btn');
        const exportBtn = document.getElementById('export-btn');
        const thumbnailPreview = document.getElementById('thumbnail-preview');
        const thumbnailInput = document.getElementById('video-thumbnail');
        const cancelVideoBtn = document.getElementById('cancel-video');
        const cancelCategoryBtn = document.getElementById('cancel-category');
        const ptBtn = document.getElementById('pt-btn');
        const enBtn = document.getElementById('en-btn');
        const themeToggleBtn = document.getElementById('theme-toggle-btn');
        
        // Verificar autenticação ao carregar a página
        document.addEventListener('DOMContentLoaded', () => {
            const isLoggedIn = localStorage.getItem('adminLoggedIn') === 'true';
            if (isLoggedIn) {
                showAdminPage();
            }
            
            // Verificar tema
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
                isDarkTheme = true;
                updateThemeIcon();
            }
            
            // Verificar idioma
            const savedLanguage = localStorage.getItem('language');
            if (savedLanguage) {
                setLanguage(savedLanguage);
            } else {
                setLanguage('pt');
            }
            
            // Carregar dados
            loadData();
            
            // Inicializar visualização
            renderVideosTable();
            renderCategoriesTable();
            populateCategorySelect();
        });
        
        // Autenticação
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === adminCredentials.username && password === adminCredentials.password) {
                localStorage.setItem('adminLoggedIn', 'true');
                showAdminPage();
            } else {
                showNotification(loginNotification, 'Credenciais inválidas. Tente novamente.', 'Invalid credentials. Try again.', 'error');
            }
        });
        
        logoutBtn.addEventListener('click', () => {
            localStorage.removeItem('adminLoggedIn');
            showLoginPage();
        });
        
        // Navegação entre seções
        videosNav.addEventListener('click', () => {
            videosNav.classList.add('active');
            categoriesNav.classList.remove('active');
            videosSection.classList.add('active');
            categoriesSection.classList.remove('active');
        });
        
        categoriesNav.addEventListener('click', () => {
            categoriesNav.classList.add('active');
            videosNav.classList.remove('active');
            categoriesSection.classList.add('active');
            videosSection.classList.remove('active');
        });
        
        // Alternância de idioma
        ptBtn.addEventListener('click', () => {
            setLanguage('pt');
        });
        
        enBtn.addEventListener('click', () => {
            setLanguage('en');
        });
        
        // Alternância de tema
        themeToggleBtn.addEventListener('click', () => {
            document.body.classList.toggle('dark-theme');
            isDarkTheme = document.body.classList.contains('dark-theme');
            localStorage.setItem('theme', isDarkTheme ? 'dark' : 'light');
            updateThemeIcon();
        });
        
        // Formulário de vídeos
        videoForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const videoData = {
                id: document.getElementById('video-id').value || generateId(),
                title: {
                    pt: document.getElementById('video-title-pt').value,
                    en: document.getElementById('video-title-en').value
                },
                description: {
                    pt: document.getElementById('video-desc-pt').value,
                    en: document.getElementById('video-desc-en').value
                },
                thumbnail: document.getElementById('video-thumbnail').value,
                videoUrl: document.getElementById('video-url').value,
                category: document.getElementById('video-category').value
            };
            
            if (editingVideoId) {
                // Editar vídeo existente
                const index = videosData.findIndex(v => v.id == editingVideoId);
                if (index !== -1) {
                    videosData[index] = videoData;
                    showNotification(adminNotification, 'Vídeo atualizado com sucesso!', 'Video updated successfully!', 'success');
                }
                editingVideoId = null;
            } else {
                // Adicionar novo vídeo
                videosData.push(videoData);
                showNotification(adminNotification, 'Vídeo adicionado com sucesso!', 'Video added successfully!', 'success');
            }
            
            saveData();
            renderVideosTable();
            resetVideoForm();
        });
        
        // Formulário de categorias
        categoryForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const categoryId = document.getElementById('category-id').value;
            
            // Verificar se o ID já existe (exceto se estiver editando)
            if (!editingCategoryId && categoriesData.some(c => c.id === categoryId)) {
                showNotification(adminNotification, 'Este ID de categoria já existe!', 'This category ID already exists!', 'error');
                return;
            }
            
            const categoryData = {
                id: categoryId,
                name: {
                    pt: document.getElementById('category-name-pt').value,
                    en: document.getElementById('category-name-en').value
                }
            };
            
            if (editingCategoryId) {
                // Editar categoria existente
                const index = categoriesData.findIndex(c => c.id === editingCategoryId);
                if (index !== -1) {
                    // Se o ID foi alterado, atualizar referências nos vídeos
                    if (editingCategoryId !== categoryId) {
                        videosData.forEach(video => {
                            if (video.category === editingCategoryId) {
                                video.category = categoryId;
                            }
                        });
                    }
                    
                    categoriesData[index] = categoryData;
                    showNotification(adminNotification, 'Categoria atualizada com sucesso!', 'Category updated successfully!', 'success');
                }
                editingCategoryId = null;
            } else {
                // Adicionar nova categoria
                categoriesData.push(categoryData);
                showNotification(adminNotification, 'Categoria adicionada com sucesso!', 'Category added successfully!', 'success');
            }
            
            saveData();
            renderCategoriesTable();
            populateCategorySelect();
            resetCategoryForm();
        });
        
        // Cancelar edição de vídeo
        cancelVideoBtn.addEventListener('click', () => {
            resetVideoForm();
        });
        
        // Cancelar edição de categoria
        cancelCategoryBtn.addEventListener('click', () => {
            resetCategoryForm();
        });
        
        // Pré-visualização de miniatura
        thumbnailInput.addEventListener('input', () => {
            const url = thumbnailInput.value;
            if (url) {
                thumbnailPreview.src = url;
                thumbnailPreview.style.display = 'block';
                
                // Verificar se a imagem carrega corretamente
                thumbnailPreview.onerror = () => {
                    thumbnailPreview.style.display = 'none';
                };
            } else {
                thumbnailPreview.style.display = 'none';
            }
        });
        
        // Exportar dados
        exportBtn.addEventListener('click', () => {
            const dataContent = generateDataJsContent();
            downloadFile('data.js', dataContent);
            showNotification(adminNotification, 'Ficheiro data.js exportado com sucesso!', 'data.js file exported successfully!', 'success');
        });
        
        // Funções auxiliares
        function showAdminPage() {
            loginPage.style.display = 'none';
            adminPage.style.display = 'block';
        }
        
        function showLoginPage() {
            adminPage.style.display = 'none';
            loginPage.style.display = 'block';
        }
        
        function setLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('language', lang);
            
            document.querySelectorAll('.lang-pt, .lang-en').forEach(el => {
                el.style.display = 'none';
            });
            
            document.querySelectorAll(`.lang-${lang}`).forEach(el => {
                el.style.display = 'block';
            });
            
            // Atualizar botões de idioma
            ptBtn.classList.toggle('active', lang === 'pt');
            enBtn.classList.toggle('active', lang === 'en');
        }
        
        function updateThemeIcon() {
            const icon = themeToggleBtn.querySelector('i');
            if (isDarkTheme) {
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');
            } else {
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');
            }
        }
        
        function showNotification(element, ptMessage, enMessage, type) {
            element.textContent = currentLanguage === 'pt' ? ptMessage : enMessage;
            element.className = `notification ${type}`;
            element.style.display = 'block';
            
            setTimeout(() => {
                element.style.display = 'none';
            }, 3000);
        }
        
        function renderVideosTable() {
            videosTable.innerHTML = '';
            
            videosData.forEach(video => {
                const tr = document.createElement('tr');
                
                const titleTd = document.createElement('td');
                titleTd.textContent = video.title[currentLanguage];
                
                const thumbnailTd = document.createElement('td');
                const thumbnailImg = document.createElement('img');
                thumbnailImg.src = video.thumbnail;
                thumbnailImg.style.width = '80px';
                thumbnailImg.style.height = '45px';
                thumbnailImg.style.objectFit = 'cover';
                thumbnailImg.style.borderRadius = '4px';
                thumbnailTd.appendChild(thumbnailImg);
                
                const categoryTd = document.createElement('td');
                const category = categoriesData.find(c => c.id === video.category);
                categoryTd.textContent = category ? category.name[currentLanguage] : video.category;
                
                const actionsTd = document.createElement('td');
                const editBtn = document.createElement('button');
                editBtn.className = 'btn-edit';
                editBtn.innerHTML = '<i class="fas fa-edit"></i>';
                editBtn.addEventListener('click', () => editVideo(video.id));
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'btn-delete';
                deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
                deleteBtn.addEventListener('click', () => deleteVideo(video.id));
                
                actionsTd.appendChild(editBtn);
                actionsTd.appendChild(deleteBtn);
                
                tr.appendChild(titleTd);
                tr.appendChild(thumbnailTd);
                tr.appendChild(categoryTd);
                tr.appendChild(actionsTd);
                
                videosTable.appendChild(tr);
            });
        }
        
        function renderCategoriesTable() {
            categoriesTable.innerHTML = '';
            
            categoriesData.forEach(category => {
                const tr = document.createElement('tr');
                
                const idTd = document.createElement('td');
                idTd.textContent = category.id;
                
                const namePtTd = document.createElement('td');
                namePtTd.textContent = category.name.pt;
                
                const nameEnTd = document.createElement('td');
                nameEnTd.textContent = category.name.en;
                
                const actionsTd = document.createElement('td');
                const editBtn = document.createElement('button');
                editBtn.className = 'btn-edit';
                editBtn.innerHTML = '<i class="fas fa-edit"></i>';
                editBtn.addEventListener('click', () => editCategory(category.id));
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'btn-delete';
                deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
                deleteBtn.addEventListener('click', () => deleteCategory(category.id));
                
                actionsTd.appendChild(editBtn);
                actionsTd.appendChild(deleteBtn);
                
                tr.appendChild(idTd);
                tr.appendChild(namePtTd);
                tr.appendChild(nameEnTd);
                tr.appendChild(actionsTd);
                
                categoriesTable.appendChild(tr);
            });
        }
        
        function populateCategorySelect() {
            const select = document.getElementById('video-category');
            select.innerHTML = '';
            
            categoriesData.forEach(category => {
                const option = document.createElement('option');
                option.value = category.id;
                option.textContent = `${category.name.pt} / ${category.name.en}`;
                select.appendChild(option);
            });
        }
        
        function editVideo(id) {
            const video = videosData.find(v => v.id == id);
            if (!video) return;
            
            document.getElementById('video-id').value = video.id;
            document.getElementById('video-title-pt').value = video.title.pt;
            document.getElementById('video-title-en').value = video.title.en;
            document.getElementById('video-desc-pt').value = video.description.pt;
            document.getElementById('video-desc-en').value = video.description.en;
            document.getElementById('video-thumbnail').value = video.thumbnail;
            document.getElementById('video-url').value = video.videoUrl;
            document.getElementById('video-category').value = video.category;
            
            // Mostrar pré-visualização da miniatura
            thumbnailPreview.src = video.thumbnail;
            thumbnailPreview.style.display = 'block';
            
            editingVideoId = video.id;
            
            // Rolar para o formulário
            videoForm.scrollIntoView({ behavior: 'smooth' });
        }
        
        function deleteVideo(id) {
            if (confirm(currentLanguage === 'pt' ? 'Tem certeza que deseja excluir este vídeo?' : 'Are you sure you want to delete this video?')) {
                videosData = videosData.filter(v => v.id != id);
                saveData();
                renderVideosTable();
                showNotification(adminNotification, 'Vídeo excluído com sucesso!', 'Video deleted successfully!', 'success');
            }
        }
        
        function editCategory(id) {
            const category = categoriesData.find(c => c.id === id);
            if (!category) return;
            
            document.getElementById('category-id-hidden').value = category.id;
            document.getElementById('category-id').value = category.id;
            document.getElementById('category-name-pt').value = category.name.pt;
            document.getElementById('category-name-en').value = category.name.en;
            
            // Desabilitar campo ID se houver vídeos usando esta categoria
            const hasVideosUsingCategory = videosData.some(v => v.category === id);
            document.getElementById('category-id').disabled = hasVideosUsingCategory;
            
            if (hasVideosUsingCategory) {
                showNotification(adminNotification, 
                    'Esta categoria está sendo usada por vídeos. O ID não pode ser alterado.', 
                    'This category is being used by videos. ID cannot be changed.', 
                    'error');
            }
            
            editingCategoryId = category.id;
            
            // Rolar para o formulário
            categoryForm.scrollIntoView({ behavior: 'smooth' });
        }
        
        function deleteCategory(id) {
            // Verificar se há vídeos usando esta categoria
            const hasVideosUsingCategory = videosData.some(v => v.category === id);
            
            if (hasVideosUsingCategory) {
                showNotification(adminNotification, 
                    'Não é possível excluir esta categoria pois há vídeos associados a ela.', 
                    'Cannot delete this category because there are videos associated with it.', 
                    'error');
                return;
            }
            
            if (confirm(currentLanguage === 'pt' ? 'Tem certeza que deseja excluir esta categoria?' : 'Are you sure you want to delete this category?')) {
                categoriesData = categoriesData.filter(c => c.id !== id);
                saveData();
                renderCategoriesTable();
                populateCategorySelect();
                showNotification(adminNotification, 'Categoria excluída com sucesso!', 'Category deleted successfully!', 'success');
            }
        }
        
        function resetVideoForm() {
            videoForm.reset();
            document.getElementById('video-id').value = '';
            thumbnailPreview.style.display = 'none';
            editingVideoId = null;
        }
        
        function resetCategoryForm() {
            categoryForm.reset();
            document.getElementById('category-id-hidden').value = '';
            document.getElementById('category-id').disabled = false;
            editingCategoryId = null;
        }
        
        function generateId() {
            return Date.now().toString();
        }
        
        function loadData() {
            const savedVideos = localStorage.getItem('adminVideos');
            const savedCategories = localStorage.getItem('adminCategories');
            
            if (savedVideos) {
                try {
                    videosData = JSON.parse(savedVideos);
                } catch (e) {
                    console.error('Erro ao carregar vídeos:', e);
                }
            }
            
            if (savedCategories) {
                try {
                    categoriesData = JSON.parse(savedCategories);
                } catch (e) {
                    console.error('Erro ao carregar categorias:', e);
                }
            }
        }
        
        function saveData() {
            localStorage.setItem('adminVideos', JSON.stringify(videosData));
            localStorage.setItem('adminCategories', JSON.stringify(categoriesData));
        }
        
        function generateDataJsContent() {
            return `// Dados dos vídeos
const videos = ${JSON.stringify(videosData, null, 2)};

// Categorias
const categories = ${JSON.stringify(categoriesData, null, 2)};`;
        }
        
        function downloadFile(filename, content) {
            const element = document.createElement('a');
            element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(content));
            element.setAttribute('download', filename);
            
            element.style.display = 'none';
            document.body.appendChild(element);
            
            element.click();
            
            document.body.removeChild(element);
        }
    </script>
</body>
</html>
